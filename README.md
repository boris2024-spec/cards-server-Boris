# Cards Server API

[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org)
[![Express](https://img.shields.io/badge/Express-5.1.0-blue.svg)](https://expressjs.com)
[![MongoDB](https://img.shields.io/badge/MongoDB-8.16+-green.svg)](https://mongodb.com)
[![Jest](https://img.shields.io/badge/Jest-29.7-red.svg)](https://jestjs.io)
[![License](https://img.shields.io/badge/License-ISC-yellow.svg)](LICENSE)

Modern Node.js / Express server for managing business cards with user system, JWT authentication, role model, and full compatibility with React frontend.

## üöÄ Features

### üë• User Management
- **Registration and authentication** with JWT tokens
- **Role system**: Regular, Business, Admin users
- **Automatic assignment of the first user** as administrator
- **Blocking system** after failed login attempts (3 attempts ‚Üí 24 hours block)
- **Administrative functions** for user management

### üéØ Business Cards
- **CRUD operations** for business cards
- **Unique 7-digit numbers** (bizNumber) with autogeneration
- **Like system** with atomic toggle mechanism
- **Card blocking** by administrators
- **Search and filter** cards

### üîí Security
- **JWT tokens** with configurable expiration time
- **CORS protection** with flexible domain settings
- **Data validation** using Joi
- **Centralized error handling**
- **Logging** of all requests and errors

### üèó Architecture
- **Modular structure** by domains (users, cards, auth)
- **Middleware system** for authentication and authorization
- **Unified API response format**
- **Comprehensive testing** (unit + integration)
- **Health-check endpoint** for monitoring

## üìã Table of Contents

1. [Quick Start](#quick-start)
2. [Installation & Setup](#installation--setup)
3. [Environment Variables](#environment-variables)
4. [API Documentation](#api-documentation)
5. [Project Architecture](#project-architecture)
6. [Testing](#testing)
7. [Frontend Compatibility](#frontend-compatibility)
8. [Deployment](#deployment)

## üèÉ‚Äç‚ôÇÔ∏è Quick Start

```bash
# Clone repository
git clone https://github.com/boris2024-spec/cards-server-Boris.git
cd cards-server-Boris

# Install dependencies
npm install

# Create .env file
cp .env.example .env

# Start MongoDB (if local)
mongod

# Start in development mode
npm run dev

# Check health
curl http://localhost:3000/health
```

## ‚öôÔ∏è Installation & Setup

### System Requirements
- **Node.js**: 18.0.0 or higher
- **MongoDB**: 5.0 or higher
- **npm**: 8.0 or higher

### –ü–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   ```bash
   npm install
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB**
   ```bash
   # –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (Ubuntu/Debian)
   sudo apt install mongodb-server
   
   # –ò–ª–∏ —á–µ—Ä–µ–∑ Docker
   docker run -d -p 27017:27017 --name mongodb mongo:latest
   ```

3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å–æ–≥–ª–∞—Å–Ω–æ –≤–∞—à–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
   ```

4. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞**
   ```bash
   # –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å hot-reload
   npm run dev
   
   # –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º
   npm start
   ```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000
NODE_ENV=development

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MongoDB
MONGODB_URI=mongodb://127.0.0.1:27017/cards_app

# JWT –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
JWT_SECRET=your_super_secret_jwt_key_change_me_in_production
JWT_EXPIRES=1h

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
ADMIN_REG_CODE=your_admin_registration_code

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∏–∑–Ω–µ—Å-–Ω–æ–º–µ—Ä–æ–≤
BIZNUM_MAX_RETRIES=5

# CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: –∑–∞–ø—è—Ç–∞—è)
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5500,http://localhost:3001

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=info
```

### –û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|------------|----------|--------------|--------------|
| `PORT` | –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ | `3000` | –ù–µ—Ç |
| `MONGODB_URI` | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB | `mongodb://127.0.0.1:27017/cards_app` | –î–∞ |
| `JWT_SECRET` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT | - | –î–∞ |
| `JWT_EXPIRES` | –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ JWT —Ç–æ–∫–µ–Ω–∞ | `1h` | –ù–µ—Ç |
| `ADMIN_REG_CODE` | –ö–æ–¥ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ | - | –ù–µ—Ç |
| `CORS_ORIGINS` | –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è CORS | `localhost:5173,127.0.0.1:5500` | –ù–µ—Ç |

## üìö API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤

–í—Å–µ API –æ—Ç–≤–µ—Ç—ã —Å–ª–µ–¥—É—é—Ç –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É:

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "data": {
    // —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏
  }
}
```

**–û—à–∏–±–∫–∞:**
```json
{
  "status": "error",
  "error": {
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
    "details": [
      {
        "path": "field_name",
        "message": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø–æ–ª—è"
      }
    ]
  }
}
```

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–°–µ—Ä–≤–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –ø–µ—Ä–µ–¥–∞—á–∏ JWT —Ç–æ–∫–µ–Ω–∞:

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± (Bearer Token):**
```javascript
fetch('/api/cards', {
  headers: {
    'Authorization': `Bearer ${token}`
  }
});
```

**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
```javascript
fetch('/api/cards', {
  headers: {
    'x-auth-token': token
  }
});
```

### üë• Users API

#### POST /users - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X POST http://localhost:3000/users \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "Password123!",
    "name": {
      "first": "John",
      "middle": "M",
      "last": "Doe"
    },
    "phone": "050-123-4567",
    "image": {
      "url": "https://example.com/avatar.jpg",
      "alt": "User avatar"
    },
    "address": {
      "state": "IL",
      "country": "Israel",
      "city": "Tel Aviv",
      "street": "Herzl",
      "houseNumber": 123,
      "zip": 12345
    },
    "isBusiness": true,
    "adminCode": "optional_admin_code"
  }'
```

#### POST /users/login - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
```bash
curl -X POST http://localhost:3000/users/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "Password123!"
  }'
```

#### GET /users - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Admin only)
```bash
curl -X GET http://localhost:3000/users \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### GET /users/:id - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
```bash
curl -X GET http://localhost:3000/users/USER_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PUT /users/:id - –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X PUT http://localhost:3000/users/USER_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": {
      "first": "Updated",
      "last": "Name"
    }
  }'
```

#### DELETE /users/:id - –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X DELETE http://localhost:3000/users/USER_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /users/:id/block - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Admin only)
```bash
curl -X PATCH http://localhost:3000/users/USER_ID/block \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /users/:id/unblock - –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Admin only)
```bash
curl -X PATCH http://localhost:3000/users/USER_ID/unblock \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /users/reset-login-attempts - –°–±—Ä–æ—Å–∏—Ç—å –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ (Admin only)
```bash
curl -X PATCH http://localhost:3000/users/reset-login-attempts \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com"
  }'
```

### üéØ Cards API

#### GET /cards - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏
```bash
curl -X GET http://localhost:3000/cards
```

#### GET /cards/my-cards - –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X GET http://localhost:3000/cards/my-cards \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### GET /cards/:id - –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ ID
```bash
curl -X GET http://localhost:3000/cards/CARD_ID
```

#### POST /cards - –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É (Business user only)
```bash
curl -X POST http://localhost:3000/cards \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "My Business",
    "subtitle": "Professional Services",
    "description": "We provide excellent services",
    "phone": "050-123-4567",
    "email": "business@example.com",
    "web": "https://mybusiness.com",
    "image": {
      "url": "https://example.com/business.jpg",
      "alt": "Business logo"
    },
    "address": {
      "state": "IL",
      "country": "Israel",
      "city": "Tel Aviv",
      "street": "Business St",
      "houseNumber": 456,
      "zip": 54321
    }
  }'
```

#### PUT /cards/:id - –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
```bash
curl -X PUT http://localhost:3000/cards/CARD_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Updated Business Name"
  }'
```

#### DELETE /cards/:id - –£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
```bash
curl -X DELETE http://localhost:3000/cards/CARD_ID \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /cards/:id/like - –õ–∞–π–∫–Ω—É—Ç—å/–¥–∏–∑–ª–∞–π–∫–Ω—É—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
```bash
curl -X PATCH http://localhost:3000/cards/CARD_ID/like \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /cards/:id/bizNumber - –ò–∑–º–µ–Ω–∏—Ç—å –±–∏–∑–Ω–µ—Å-–Ω–æ–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏
```bash
curl -X PATCH http://localhost:3000/cards/CARD_ID/bizNumber \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /cards/:id/block - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É (Admin only)
```bash
curl -X PATCH http://localhost:3000/cards/CARD_ID/block \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

#### PATCH /cards/:id/unblock - –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É (Admin only)
```bash
curl -X PATCH http://localhost:3000/cards/CARD_ID/unblock \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### üîç –°–ª—É–∂–µ–±–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### GET /health - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
```bash
curl -X GET http://localhost:3000/health
```

–û—Ç–≤–µ—Ç:
```json
{
  "status": "ok",
  "uptime": 123.45,
  "db": "connected"
}
```

#### GET /ping - –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
```bash
curl -X GET http://localhost:3000/ping
```

–û—Ç–≤–µ—Ç: `pong`

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
cards-server-Boris/
‚îú‚îÄ‚îÄ üìÅ auth/                    # –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jwtProvider.js      # JWT —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ authService.js      # Middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üìÅ cards/                   # –ú–æ–¥—É–ª—å –∫–∞—Ä—Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cardPermissions.js  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Card.js             # Mongoose –º–æ–¥–µ–ª—å –∫–∞—Ä—Ç–æ—á–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cardsController.js  # –†–æ—É—Ç—ã –∫–∞—Ä—Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bizNumberService.js # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–Ω–æ–º–µ—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cardsDataService.js # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cardsService.js     # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dtoService.js       # DTO –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ validation/
‚îÇ       ‚îú‚îÄ‚îÄ cardValidationSchema.js    # Joi —Å—Ö–µ–º—ã
‚îÇ       ‚îî‚îÄ‚îÄ cardValidationService.js   # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å
‚îú‚îÄ‚îÄ üìÅ users/                   # –ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ helpers/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bcrypt.js           # –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginAttempt.js     # –ú–æ–¥–µ–ª—å –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ User.js             # Mongoose –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usersController.js  # –†–æ—É—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loginAttemptService.js    # –°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usersDataService.js       # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usersService.js           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ validation/
‚îÇ       ‚îî‚îÄ‚îÄ userValidationSchema.js   # Joi —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ üìÅ middlewares/             # –û–±—â–∏–µ middleware
‚îÇ   ‚îú‚îÄ‚îÄ errorHandler.js         # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ logger.js               # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ response.js             # –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ üìÅ helpers/                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ mongooseValidators.js   # Mongoose –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ submodels/              # –ü–æ–¥–º–æ–¥–µ–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ Address.js          # –°—Ö–µ–º–∞ –∞–¥—Ä–µ—Å–∞
‚îÇ       ‚îú‚îÄ‚îÄ Image.js            # –°—Ö–µ–º–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ Name.js             # –°—Ö–µ–º–∞ –∏–º–µ–Ω–∏
‚îú‚îÄ‚îÄ üìÅ tests/                   # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ app.ping.test.js        # –¢–µ—Å—Ç ping —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ auth.header.test.js     # –¢–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ card.blocking.test.js   # –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫
‚îÇ   ‚îú‚îÄ‚îÄ card.validation.messages.test.js  # –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ health.test.js          # –¢–µ—Å—Ç health —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ integration.flow.test.js          # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ user.blocking.test.js   # –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ üìÅ config/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üìÅ DB/                      # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ üìÅ logs/                    # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üìÅ public/                  # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îî‚îÄ‚îÄ üìÅ router/                  # –û—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –¥–æ–º–µ–Ω (users, cards, auth) –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω
2. **Layered Architecture**: Controller ‚Üí Service ‚Üí DataService ‚Üí Model
3. **Middleware —Å–∏—Å—Ç–µ–º–∞**: –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—à–∏–±–æ–∫
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –î–≤–æ–π–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (Joi + Mongoose)
5. **Error Handling**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

### –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å

| –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |
|------|----------|-------------|
| **Regular User** | –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç–æ—á–µ–∫, –ª–∞–π–∫–∏ |
| **Business User** | –ë–∏–∑–Ω–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | + –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ |
| **Admin** | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | + –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ |

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### User Schema
```javascript
{
  _id: ObjectId,
  email: String,               // unique, –≤–∞–ª–∏–¥–∞—Ü–∏—è email
  password: String,            // bcrypt —Ö–µ—à
  name: {
    first: String,             // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    middle: String,            // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ
    last: String               // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
  },
  phone: String,               // –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  image: {
    url: String,               // URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    alt: String                // alt —Ç–µ–∫—Å—Ç
  },
  address: {
    state: String,
    country: String,           // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    city: String,              // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    street: String,            // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    houseNumber: Number,       // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    zip: Number                // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ
  },
  isAdmin: Boolean,            // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false
  isBusiness: Boolean,         // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false
  isBlocked: Boolean,          // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false
  createdAt: Date              // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
}
```

#### Card Schema
```javascript
{
  _id: ObjectId,
  title: String,               // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
  subtitle: String,            // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
  description: String,         // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, –¥–æ 1024 —Å–∏–º–≤–æ–ª–æ–≤
  phone: String,               // –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
  email: String,               // –≤–∞–ª–∏–¥–∞—Ü–∏—è email
  web: String,                 // –≤–∞–ª–∏–¥–∞—Ü–∏—è URL
  image: {
    url: String,               // URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    alt: String                // alt —Ç–µ–∫—Å—Ç
  },
  address: {                   // –∫–∞–∫ –≤ User
    state: String,
    country: String,
    city: String,
    street: String,
    houseNumber: Number,
    zip: Number
  },
  bizNumber: Number,           // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π 7-–∑–Ω–∞—á–Ω—ã–π –Ω–æ–º–µ—Ä
  likes: [String],             // –º–∞—Å—Å–∏–≤ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  isBlocked: Boolean,          // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false
  createdAt: Date,             // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  user_id: String              // ID –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
}
```

#### LoginAttempt Schema
```javascript
{
  email: String,               // email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  attempts: Number,            // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
  blockedUntil: Date,          // –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  lastAttempt: Date            // –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ø—ã—Ç–∫–∏
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
npm test

# –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
npm test -- --testPathPattern=user.blocking
npm test -- --testPathPattern=integration.flow
npm test -- --testPathPattern=card.validation

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
npm test -- --coverage

# –í watch —Ä–µ–∂–∏–º–µ
npm test -- --watch
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

1. **Unit —Ç–µ—Å—Ç—ã**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
   - `card.validation.messages.test.js` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
   - `auth.header.test.js` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

2. **Integration —Ç–µ—Å—Ç—ã**: –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
   - `integration.flow.test.js` - –ø–æ–ª–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—É—Ç—å
   - `user.blocking.test.js` - —Å–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
   - `card.blocking.test.js` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫

3. **API —Ç–µ—Å—Ç—ã**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
   - `app.ping.test.js` - –±–∞–∑–æ–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
   - `health.test.js` - health check

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç (integration.flow.test.js)
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT
3. –°–æ–∑–¥–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–∫–∞—Ä—Ç–æ—á–∫–∏
4. –õ–∞–π–∫ –∫–∞—Ä—Ç–æ—á–∫–∏
5. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ª–∞–π–∫ (–æ—Ç–º–µ–Ω–∞)
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (user.blocking.test.js)
1. 3 –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 24 —á–∞—Å–∞
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
4. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–±—Ä–æ—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### –î–µ–º–æ —Å–∫—Ä–∏–ø—Ç—ã

```bash
# Windows PowerShell –¥–µ–º–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
.\demo_user_blocking.ps1

# Unix/Linux –¥–µ–º–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
./demo_user_blocking.sh
```

## üåê –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

### React Frontend Compatibility

–°–µ—Ä–≤–µ—Ä –Ω–∞ 100% —Å–æ–≤–º–µ—Å—Ç–∏–º —Å React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º:
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: https://github.com/boris2024-spec/cards-proj-Boris-main-main
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**: React 19.1.0, MUI 7.1.0, Vite 6, Axios

### API —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:**
- Users API: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- Cards API: —Å–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ª–∞–π–∫–∏
- Admin API: –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–∞—Ä—Ç–æ—á–µ–∫

‚úÖ **–ò–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:**
- User –∏ Card –º–æ–¥–µ–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (Joi)
- –°–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤

‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
- JWT —Ç–æ–∫–µ–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

### CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```env
# –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5500

# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
CORS_ORIGINS=https://your-frontend-domain.com,https://app.example.com
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

–í —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–æ–µ–∫—Ç–µ —Å–æ–∑–¥–∞–π—Ç–µ `.env.local`:
```env
VITE_API_BASE=http://localhost:3000
# –ò–ª–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
# VITE_API_BASE=https://your-backend-domain.com
```

## üîí –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### JWT —Ç–æ–∫–µ–Ω—ã
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: HS256
- **–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**: `{ _id, isBusiness, isAdmin }`
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `JWT_EXPIRES`
- **–°–µ–∫—Ä–µ—Ç**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `JWT_SECRET` –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Ö–æ–¥–∞
- **–õ–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫**: 3 –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
- **–í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**: 24 —á–∞—Å–∞
- **–°–±—Ä–æ—Å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —á–µ—Ä–µ–∑ TTL –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Frontend –≤–∞–ª–∏–¥–∞—Ü–∏—è**: Joi —Å—Ö–µ–º—ã
- **Backend –≤–∞–ª–∏–¥–∞—Ü–∏—è**: Mongoose + Joi
- **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø–æ–ª–µ–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏**: bcrypt —Å salt

### CORS –∑–∞—â–∏—Ç–∞
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –¥–æ–º–µ–Ω—ã**: –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **Credentials**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- **–ú–µ—Ç–æ–¥—ã**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ REST API

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### Health Check
```bash
curl http://localhost:3000/health
```

–û—Ç–≤–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç:
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
- –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (uptime)
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- HTTP —Å—Ç–∞—Ç—É—Å 200 (OK) –∏–ª–∏ 503 (Service Unavailable)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**Morgan middleware** –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤:
```
GET /cards 200 45ms - 1.2kb
POST /users/login 401 12ms - 0.5kb
```

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–∏** –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `logs/`:
- `app.log` - —Ç–µ–∫—É—â–∏–µ –ª–æ–≥–∏
- `app-YYYY-MM-DD.log` - –∞—Ä—Ö–∏–≤–Ω—ã–µ –ª–æ–≥–∏ –ø–æ –¥–Ω—è–º

**–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**:
- `info` - –æ–±—ã—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `warn` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `error` - –æ—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `debug` - –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- Response time per endpoint
- Error rate (4xx, 5xx)
- Database connection status
- JWT token validation errors
- Failed login attempts
- Active user sessions

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB**:
   ```bash
   # Docker –≤–∞—Ä–∏–∞–Ω—Ç
   docker run -d -p 27017:27017 --name mongodb mongo:latest
   
   # –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
   brew install mongodb-community    # macOS
   sudo apt install mongodb-server   # Ubuntu
   ```

2. **–ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ**:
   ```bash
   npm run dev
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   curl http://localhost:3000/health
   ```

### –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

#### Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

**Dockerfile:**
```dockerfile
FROM node:18-alpine

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
EXPOSE 3000

CMD ["npm", "start"]
```

**docker-compose.yml:**
```yaml
version: '3.8'
services:
  cards-server:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - MONGODB_URI=mongodb://mongo:27017/cards_app
      - JWT_SECRET=${JWT_SECRET}
    depends_on:
      - mongo
    
  mongo:
    image: mongo:5
    volumes:
      - mongo_data:/data/db
    
volumes:
  mongo_data:
```

**–ó–∞–ø—É—Å–∫:**
```bash
docker-compose up -d
```

#### Heroku —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
heroku create your-cards-server

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ MongoDB (MongoAtlas addon)
heroku addons:create mongolab:sandbox

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
heroku config:set JWT_SECRET=your_production_jwt_secret
heroku config:set ADMIN_REG_CODE=your_admin_code
heroku config:set CORS_ORIGINS=https://your-frontend.herokuapp.com

# –î–µ–ø–ª–æ–π
git push heroku main
```

#### VPS/Cloud —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# PM2 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
npm install -g pm2

# –°–æ–∑–¥–∞–Ω–∏–µ ecosystem —Ñ–∞–π–ª–∞
cat > ecosystem.config.js << EOF
module.exports = {
  apps: [{
    name: 'cards-server',
    script: 'server.js',
    instances: 'max',
    env: {
      NODE_ENV: 'development'
    },
    env_production: {
      NODE_ENV: 'production',
      PORT: 3000
    }
  }]
}
EOF

# –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
pm2 start ecosystem.config.js --env production
pm2 save
pm2 startup
```

#### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```env
# –ü—Ä–æ–¥–∞–∫—à–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
NODE_ENV=production
PORT=3000

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
JWT_SECRET=your_very_long_and_secure_jwt_secret_here
ADMIN_REG_CODE=super_secure_admin_registration_code

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (MongoDB Atlas —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/cards_app

# CORS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
CORS_ORIGINS=https://your-frontend.com,https://app.your-domain.com

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
LOG_LEVEL=warn
BIZNUM_MAX_RETRIES=10
```

## üõ† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

### –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
node clear_db.js
```

### –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```bash
node seed.js
```

### –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**package.json scripts:**
```json
{
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js",
    "test": "powershell -Command \"$env:NODE_ENV='test'; node --experimental-vm-modules ./node_modules/jest/bin/jest.js --detectOpenHandles\"",
    "test:watch": "npm test -- --watch",
    "test:coverage": "npm test -- --coverage",
    "lint": "eslint .",
    "seed": "node seed.js",
    "clear-db": "node clear_db.js"
  }
}
```

## üìã TODO / –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] **Refresh —Ç–æ–∫–µ–Ω—ã** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è JWT
- [ ] **Email change endpoint** - –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è —Å–º–µ–Ω—ã email
- [ ] **Swagger/OpenAPI** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] **Rate limiting** –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- [ ] **Soft delete** –≤–º–µ—Å—Ç–æ –∂–µ—Å—Ç–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏
- [ ] **Redis** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–µ—Å—Å–∏–π
- [ ] **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- [ ] **Image upload** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –∏ –∫–∞—Ä—Ç–æ—á–µ–∫
- [ ] **Search API** –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
- [ ] **Pagination** –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø–ª–∞–Ω—ã
- [ ] **Microservices** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] **GraphQL** API –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ REST
- [ ] **Real-time** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSocket
- [ ] **Analytics** –∏ –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] **API versioning** –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] **2FA** –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] **OAuth** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (Google, Facebook)
- [ ] **IP-based blocking** –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ email –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
- [ ] **CAPTCHA** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ—Å–ª–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á
- [ ] **Security headers** (Helmet.js —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)

### DevOps
- [ ] **CI/CD pipeline** (GitHub Actions)
- [ ] **Automated testing** –≤ CI
- [ ] **Code quality** –ø—Ä–æ–≤–µ—Ä–∫–∏ (SonarQube)
- [ ] **Performance monitoring** (New Relic, DataDog)
- [ ] **Automated backups** –¥–ª—è MongoDB

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

### –ö–∞–∫ –≤–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥

1. **Fork** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ **feature branch**: `git checkout -b feature/amazing-feature`
3. **Commit** –∏–∑–º–µ–Ω–µ–Ω–∏—è: `git commit -m 'Add amazing feature'`
4. **Push** –≤ branch: `git push origin feature/amazing-feature`
5. –û—Ç–∫—Ä–æ–π—Ç–µ **Pull Request**

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞

- **ESLint** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `eslint.config.js`
- **Conventional Commits** –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –∫–æ–º–º–∏—Ç–æ–≤
- **Jest** –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **JSDoc** –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö API

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ PR

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
npm test

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞
npm run lint

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è TypeScript)
npm run type-check
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ [ISC License](LICENSE).

## üë• –ê–≤—Ç–æ—Ä—ã –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- **Boris** - –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫
- **–ö–æ–º–∞–Ω–¥–∞ –∫—É—Ä—Å–∞ Full Stack** - –ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
- **Express.js** –∫–æ–º–∞–Ω–¥–µ –∑–∞ –æ—Ç–ª–∏—á–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **MongoDB** –∑–∞ –Ω–∞–¥–µ–∂–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- **Jest** –∑–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Joi** –∑–∞ –º–æ—â–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **GitHub Issues**: [–°–æ–∑–¥–∞—Ç—å issue](https://github.com/boris2024-spec/cards-server-Boris/issues)
2. **Email**: boris2024.spec@example.com
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ß–∏—Ç–∞–π—Ç–µ —ç—Ç–æ—Ç README –∏ –∫–æ–¥ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)

**Q: –ö–∞–∫ —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?**
A: –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞?**
A: –î–∞, –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `MAX_ATTEMPTS` –≤ `loginAttemptService.js`.

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ –∫–∞—Ä—Ç–æ—á–∫—É?**
A: –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ö–µ–º—É –≤ `Card.js`, –¥–æ–±–∞–≤—å—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `cardValidationSchema.js` –∏ —Ç–µ—Å—Ç—ã.

**Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–π —Ä–µ–∂–∏–º?**
A: –î–∞, —Å–µ—Ä–≤–µ—Ä stateless –∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —Å –≤–Ω–µ—à–Ω–µ–π MongoDB.

---

**üéØ Cards Server API - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∫–∞—Ä—Ç–æ—á–∫–∞–º–∏**

*–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤*
